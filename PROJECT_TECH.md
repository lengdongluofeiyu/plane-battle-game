# é£æœºå¤§æˆ˜ - é¡¹ç›®æŠ€æœ¯è¯´æ˜

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

é£æœºå¤§æˆ˜æ˜¯ä¸€æ¬¾ä½¿ç”¨ Next.js 15 + React + TypeScript å¼€å‘çš„2Då°„å‡»æ¸¸æˆã€‚æ¸¸æˆä½¿ç”¨ HTML5 Canvas è¿›è¡Œæ¸²æŸ“ï¼Œé€šè¿‡é”®ç›˜æ§åˆ¶æˆ˜æœºï¼Œè‡ªåŠ¨å°„å‡»å‡»è´¥ä¸åŒç±»å‹çš„æ•Œæœºï¼Œå¹¶æ”¶é›†é“å…·å¢å¼ºæˆ˜æ–—åŠ›ã€‚æ¸¸æˆè¿˜åŒ…å«å†å²æœ€é«˜åˆ†è®°å½•åŠŸèƒ½ï¼Œæ•°æ®ä½¿ç”¨ SQLite + Prisma è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨ã€‚

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯æ¡†æ¶
- **Next.js 15.3.5** - React æ¡†æ¶ï¼Œä½¿ç”¨ App Router æ¶æ„
  - æä¾›ç°ä»£åŒ–çš„ React å¼€å‘ä½“éªŒ
  - æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰å’Œé™æ€ç”Ÿæˆæ”¯æŒ
  - å†…ç½®è·¯ç”±ç³»ç»Ÿå’Œ API è·¯ç”±
  - ä¼˜ç§€çš„å¼€å‘ä½“éªŒå’Œæ€§èƒ½ä¼˜åŒ–

### ç¼–ç¨‹è¯­è¨€
- **TypeScript 5** - ç±»å‹å®‰å…¨çš„ JavaScript è¶…é›†
  - æä¾›é™æ€ç±»å‹æ£€æŸ¥ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
  - å¢å¼ºä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§
  - æ™ºèƒ½ä»£ç æç¤ºå’Œè‡ªåŠ¨è¡¥å…¨

### UI æ¡†æ¶
- **shadcn/ui** - åŸºäº Radix UI çš„ç°ä»£ç»„ä»¶åº“
  - Card - æ¸¸æˆç•Œé¢å®¹å™¨
  - Button - å¼€å§‹æ¸¸æˆæŒ‰é’®
  - æä¾› New York é£æ ¼çš„ç²¾ç¾ UI ç»„ä»¶
  - å®Œå…¨å¯å®šåˆ¶çš„ç»„ä»¶è®¾è®¡ç³»ç»Ÿ
  - å†…ç½®æ— éšœç¢è®¿é—®æ”¯æŒ

### æ ·å¼æ–¹æ¡ˆ
- **Tailwind CSS 4** - å®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶
  - å¿«é€Ÿæ„å»ºå“åº”å¼ç•Œé¢
  - æ·±è‰²æ¨¡å¼æ”¯æŒï¼ˆä½¿ç”¨ next-themesï¼‰
  - å†…ç½®åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ
  - æå°çš„ç”Ÿäº§ç¯å¢ƒåŒ…ä½“ç§¯

### å›¾å½¢æ¸²æŸ“
- **HTML5 Canvas API** - 2D å›¾å½¢æ¸²æŸ“
  - é«˜æ€§èƒ½çš„æ¸¸æˆç”»é¢æ¸²æŸ“
  - requestAnimationFrame å®ç°æµç•…çš„ 60FPS åŠ¨ç”»
  - æ”¯æŒæ¸å˜ã€è·¯å¾„ã€åœ†å¼§ç­‰ç»˜å›¾æ“ä½œ
  - é€‚åˆå®ç°ç²’å­æ•ˆæœå’ŒåŠ¨ç”»

### æ•°æ®åº“
- **SQLite** - è½»é‡çº§å…³ç³»å‹æ•°æ®åº“
  - æ— éœ€é¢å¤–æ•°æ®åº“æœåŠ¡ï¼Œæ–‡ä»¶å­˜å‚¨
  - é€‚åˆå°å‹é¡¹ç›®å’Œæœ¬åœ°å¼€å‘
  - æ”¯æŒ ACID äº‹åŠ¡

### ORM
- **Prisma** - ç°ä»£åŒ–çš„ TypeScript ORM
  - ç±»å‹å®‰å…¨çš„æ•°æ®åº“æŸ¥è¯¢
  - æ•°æ®æ¨¡å‹å®šä¹‰å’Œè¿ç§»ç®¡ç†
  - è‡ªåŠ¨ç”Ÿæˆ TypeScript ç±»å‹å®šä¹‰
  - ä¼˜ç§€çš„å¼€å‘è€…ä½“éªŒ

### çŠ¶æ€ç®¡ç†
- **React Hooks** - å†…ç½®çŠ¶æ€ç®¡ç†
  - useState - ç»„ä»¶çŠ¶æ€ç®¡ç†
  - useRef - å¯å˜å¼•ç”¨ï¼ˆé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼‰
  - useEffect - å‰¯ä½œç”¨å¤„ç†
  - useCallback - æ€§èƒ½ä¼˜åŒ–

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
my-project/
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma          # Prisma æ•°æ®æ¨¡å‹å®šä¹‰
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ highscore/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts   # æœ€é«˜åˆ† API æ¥å£
â”‚   â”‚   â”œâ”€â”€ page.tsx           # ä¸»é¡µé¢ï¼ˆæ¸¸æˆå…¥å£ï¼‰
â”‚   â”‚   â””â”€â”€ layout.tsx         # åº”ç”¨å¸ƒå±€
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/                # shadcn/ui ç»„ä»¶åº“
â”‚   â”‚   â””â”€â”€ PlaneGame.tsx      # æ¸¸æˆä¸»ç»„ä»¶
â”‚   â””â”€â”€ lib/
â”‚       â””â”€â”€ db.ts              # Prisma å®¢æˆ·ç«¯é…ç½®
â”œâ”€â”€ public/                   # é™æ€èµ„æº
â””â”€â”€ package.json              # é¡¹ç›®ä¾èµ–é…ç½®
```

---

## ğŸ® æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. æ¸¸æˆå¾ªç¯
ä½¿ç”¨ `requestAnimationFrame` å®ç°é«˜æ€§èƒ½æ¸¸æˆå¾ªç¯ï¼Œæ¯å¸§è°ƒç”¨ `updateGame` å‡½æ•°æ›´æ–°æ¸¸æˆçŠ¶æ€å’Œæ¸²æŸ“ç”»é¢ã€‚

### 2. ç¢°æ’æ£€æµ‹
é‡‡ç”¨ AABBï¼ˆAxis-Aligned Bounding Boxï¼‰ç¢°æ’æ£€æµ‹ç®—æ³•ï¼š
- ç©å®¶ä¸æ•Œæœºç¢°æ’
- å­å¼¹ä¸æ•Œæœºç¢°æ’
- ç©å®¶ä¸é“å…·ç¢°æ’

### 3. æ¸¸æˆå¯¹è±¡ç®¡ç†
ä½¿ç”¨ React çš„ `useRef` å­˜å‚¨æ¸¸æˆå¯¹è±¡æ•°ç»„ï¼Œé¿å…çŠ¶æ€æ›´æ–°å¯¼è‡´çš„é‡æ¸²æŸ“ï¼š
- `bulletsRef` - å­å¼¹æ•°ç»„
- `enemiesRef` - æ•Œæœºæ•°ç»„
- `powerUpsRef` - é“å…·æ•°ç»„
- `explosionsRef` - çˆ†ç‚¸ç‰¹æ•ˆæ•°ç»„

### 4. è¾“å…¥å¤„ç†
ç›‘å¬é”®ç›˜äº‹ä»¶ï¼ˆkeydown/keyupï¼‰ï¼Œä½¿ç”¨å¯¹è±¡è·Ÿè¸ªæŒ‰é”®çŠ¶æ€ï¼Œæ”¯æŒ WASD å’Œæ–¹å‘é”®æ§åˆ¶ã€‚

### 5. æ•°æ®æŒä¹…åŒ–
- ä½¿ç”¨ Prisma + SQLite å­˜å‚¨æœ€é«˜åˆ†
- æä¾› RESTful API æ¥å£ï¼ˆGET/POSTï¼‰
- è‡ªåŠ¨æ£€æµ‹å¹¶æ›´æ–°å†å²æœ€é«˜åˆ†

---

## ğŸ¨ æ¸¸æˆç‰¹æ€§

### ç©å®¶ç³»ç»Ÿ
- âœ… WASD / æ–¹å‘é”®ç§»åŠ¨æ§åˆ¶
- âœ… è‡ªåŠ¨å°„å‡»ï¼ˆå¯è°ƒèŠ‚å°„é€Ÿï¼‰
- âœ… ç”Ÿå‘½å€¼ç³»ç»Ÿ
- âœ… é“å…·å¢å¼ºç³»ç»Ÿ

### æ•Œæœºç³»ç»Ÿ
- ğŸ”´ å°å‹æ•Œæœºï¼šé€Ÿåº¦å¿«ï¼Œè¡€é‡ä½ï¼Œ10åˆ†
- ğŸŸ  ä¸­å‹æ•Œæœºï¼šé€Ÿåº¦ä¸­ï¼Œè¡€é‡ä¸­ï¼Œ25åˆ†
- ğŸŸ£ å¤§å‹æ•Œæœºï¼šé€Ÿåº¦æ…¢ï¼Œè¡€é‡é«˜ï¼Œ50åˆ†
- åŠ¨æ€ç”Ÿæˆæ¦‚ç‡éšåˆ†æ•°å¢åŠ 

### é“å…·ç³»ç»Ÿ
- ğŸ’ SIZEï¼šå¢å¤§å­å¼¹ä½“ç§¯ï¼ˆæé«˜ä¼¤å®³ï¼‰
- âš¡ RATEï¼šå¢åŠ å‘å°„é€Ÿç‡
- ğŸ”¥ MULTï¼šå¢åŠ åŒæ—¶å‘å°„çš„å­å¼¹æ•°é‡
- 30% æ‰è½æ¦‚ç‡

### è§†è§‰æ•ˆæœ
- âœ¨ æ˜Ÿç©ºèƒŒæ™¯åŠ¨ç”»
- ğŸ’¥ çˆ†ç‚¸ç‰¹æ•ˆï¼ˆå¸¦æ·¡å‡ºæ•ˆæœï¼‰
- ğŸ¨ æ¸å˜è‰²æˆ˜æœºå’Œæ•Œæœº
- ğŸ“Š å®æ—¶è¡€æ¡æ˜¾ç¤º
- ğŸŒ— æ·±è‰²ä¸»é¢˜è®¾è®¡

---

## ğŸ”‘ æ ¸å¿ƒä»£ç è¯´æ˜

### TypeScript æ¥å£å®šä¹‰

```typescript
// ç©å®¶æˆ˜æœºæ¥å£
interface Player {
  x: number          // Xåæ ‡
  y: number          // Yåæ ‡
  width: number      // æˆ˜æœºå®½åº¦
  height: number     // æˆ˜æœºé«˜åº¦
  speed: number      // ç§»åŠ¨é€Ÿåº¦
  health: number     // å½“å‰ç”Ÿå‘½å€¼
  maxHealth: number  // æœ€å¤§ç”Ÿå‘½å€¼
  bulletSize: number // å­å¼¹å¤§å°å€æ•°
  fireRate: number   // å°„å‡»é—´éš”
  bulletCount: number // åŒæ—¶å‘å°„å­å¼¹æ•°
  lastShot: number   // ä¸Šæ¬¡å°„å‡»æ—¶é—´
}

// æ•Œæœºæ¥å£
interface Enemy {
  x: number
  y: number
  width: number
  height: number
  speed: number
  health: number
  maxHealth: number
  type: 'small' | 'medium' | 'large'
}
```

### æ¸¸æˆä¸»æ›´æ–°å¾ªç¯

```typescript
const updateGame = useCallback((timestamp: number) => {
  // 1. æ¸…ç©ºç”»å¸ƒ
  ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT)

  // 2. ç»˜åˆ¶èƒŒæ™¯
  drawBackground(ctx, timestamp)

  // 3. æ›´æ–°ç©å®¶ä½ç½®
  updatePlayerPosition()

  // 4. å‘å°„å­å¼¹
  shootBullet(timestamp)

  // 5. æ›´æ–°å­å¼¹ä½ç½®å’Œç¢°æ’æ£€æµ‹
  updateBullets()

  // 6. ç”Ÿæˆå’Œæ›´æ–°æ•Œæœº
  spawnAndEnemies()

  // 7. æ›´æ–°é“å…·
  updatePowerUps()

  // 8. æ›´æ–°çˆ†ç‚¸ç‰¹æ•ˆ
  updateExplosions()

  // 9. ç»˜åˆ¶ç©å®¶
  drawPlayer(ctx)

  // 10. æ£€æŸ¥æ¸¸æˆç»“æŸ
  checkGameOver()
}, [gameState, score, health])
```

### API æ¥å£ç¤ºä¾‹

```typescript
// GET /api/highscore - è·å–æœ€é«˜åˆ†
export async function GET() {
  const highScore = await db.gameScore.findFirst({
    orderBy: { score: 'desc' }
  })
  return NextResponse.json({
    success: true,
    highScore: highScore?.score || 0
  })
}

// POST /api/highscore - æ›´æ–°æœ€é«˜åˆ†
export async function POST(request: NextRequest) {
  const { score } = await request.json()
  const currentHighScore = await db.gameScore.findFirst({
    orderBy: { score: 'desc' }
  })

  if (!currentHighScore || score > currentHighScore.score) {
    const newHighScore = await db.gameScore.create({
      data: { score }
    })
    return NextResponse.json({
      success: true,
      highScore: newHighScore.score,
      isNewRecord: true
    })
  }

  return NextResponse.json({
    success: true,
    highScore: currentHighScore.score,
    isNewRecord: false
  })
}
```

---

## ğŸš€ å¼€å‘å’Œéƒ¨ç½²

### å¼€å‘å‘½ä»¤
```bash
# å®‰è£…ä¾èµ–
bun install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
bun run dev

# ä»£ç æ£€æŸ¥
bun run lint

# æ•°æ®åº“è¿ç§»
bun run db:push
```

### æŠ€æœ¯ä¼˜åŠ¿

1. **ç±»å‹å®‰å…¨**ï¼šTypeScript + Prisma æä¾›ç«¯åˆ°ç«¯çš„ç±»å‹æ£€æŸ¥
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šCanvas æ¸²æŸ“ + useRef é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
3. **å¼€å‘ä½“éªŒ**ï¼šNext.js çƒ­é‡è½½ + ESLint ä»£ç æ£€æŸ¥
4. **ç°ä»£åŒ–**ï¼šReact Hooks + App Router + shadcn/ui
5. **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„é¡¹ç›®ç»“æ„å’Œä»£ç æ³¨é‡Š

---

## ğŸ“ˆ æ‰©å±•æ€§

é¡¹ç›®è®¾è®¡æ”¯æŒä»¥ä¸‹æ‰©å±•æ–¹å‘ï¼š

1. **æ¸¸æˆå†…å®¹**
   - æ›´å¤šæ•Œæœºç±»å‹å’Œ Boss æˆ˜
   - æ›´å¤šé“å…·ç±»å‹
   - å…³å¡ç³»ç»Ÿ
   - å¤šäººè”æœºæ¨¡å¼

2. **åŠŸèƒ½å¢å¼º**
   - ç©å®¶æ’è¡Œæ¦œï¼ˆå¤šç”¨æˆ·ï¼‰
   - éŸ³æ•ˆå’ŒèƒŒæ™¯éŸ³ä¹
   - æˆå°±ç³»ç»Ÿ
   - å­˜æ¡£åŠŸèƒ½

3. **æŠ€æœ¯ä¼˜åŒ–**
   - WebSocket å®æ—¶å¯¹æˆ˜
   - Web Worker å¤„ç†æ¸¸æˆé€»è¾‘
   - PWA æ”¯æŒï¼ˆç¦»çº¿æ¸¸ç©ï¼‰
   - ç§»åŠ¨ç«¯è§¦æ§æ”¯æŒ

---

## ğŸ“ æ€»ç»“

æœ¬é¡¹ç›®å±•ç¤ºäº†ç°ä»£ Web å¼€å‘æŠ€æœ¯çš„ç»¼åˆè¿ç”¨ï¼š

- âœ… **Next.js 15** - ç°ä»£åŒ– React æ¡†æ¶
- âœ… **TypeScript** - ç±»å‹å®‰å…¨å¼€å‘
- âœ… **Canvas API** - é«˜æ€§èƒ½ 2D å›¾å½¢æ¸²æŸ“
- âœ… **Prisma** - ç±»å‹å®‰å…¨çš„æ•°æ®åº“ ORM
- âœ… **shadcn/ui** - ç²¾ç¾çš„ UI ç»„ä»¶åº“
- âœ… **Tailwind CSS** - ç°ä»£åŒ–æ ·å¼æ–¹æ¡ˆ

é¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œä»£ç æ³¨é‡Šå®Œæ•´ï¼Œé€‚åˆä½œä¸ºå­¦ä¹ å’Œå‚è€ƒçš„ä¼˜ç§€ç¤ºä¾‹ã€‚
